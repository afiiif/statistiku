importScripts("../v3.0/utils.js");export const index=(e,a,t,i,n,s)=>{const l=Date.now();let h=e["y[]"].map(e=>n[e]).join(", "),r=ร(a[0].length,h,e.g.length?`by <b>${n[e.g]}</b>`:""),o=e["y[]"].map(e=>!a[i[e]].some(e=>null===e||isNaN(e))&&!s.find(a=>a[0]==n[e])&&สน(mean(a[i[e]],t))),m="";for(let a=0,t=o.length;a<t;a++)if(!1===o[a])return{error:`Invalid variable: <b class="text-warning">${n[e["y[]"][a]]}</b> contains non-numeric value`+shake("y[]")};if(e.g.length){var c=a[i[e.g]].unq();if(c.length>100)return{error:`Invalid group: <b class="text-warning">${n[e.g]}</b> contains more than 100 unique values`+shake("g")};e["y[]"].forEach((h,r)=>{let d=void 0,g=a[i[h]].min(),p=a[i[h]].max(),v=histoSpline.k(a[i[h]],t);m+=(r?"<hr>":"")+`<h6>${n[h]} <span class="fw-300">by ${n[e.g]}</span></h6>`+gvar(`hc${l}_mean${r}`,["mean",{color:"#777",id:"mean",width:2,value:d=mean(a[i[h]],t),label:{text:d.toFixed(Math.max(0,o[r]))},dashStyle:"shortdash",zIndex:999}])+highcharts(l+r,["histogram","areaSpline"],"{ series: ["+split(a,i[e.g]).map((a,t)=>`{ name: "${vlabel(c[t],s,n[e.g])}", data:${JSON.stringify(histoSpline.bin(a[i[h]],a[i[e.weight]],v,g,p).map(e=>[e.mid,e.f]))}, color:Highcharts.getOptions().colors[${t}] }`).join(",")+`,{ type: 'line', visible: false, color: '#777', name: 'Overall Mean', dashStyle: 'shortdash', marker:{enabled:false}, events:{legendItemClick:function(e){if(this.visible){this.chart.xAxis[0].removePlotLine(hc${l}_mean${r}[0])}else{this.chart.xAxis[0].addPlotLine(hc${l}_mean${r}[1])}}} }`+"]"+(e.a?',plotOptions: { areaspline: { stacking: "normal" } }':"")+"}")}),m+=highchartsReflow(e["y[]"].map((e,a)=>l+a))}else e["y[]"].forEach((e,s)=>{let h=void 0;m+=(s?"<hr>":"")+`<h6>${n[e]}</h6>`+gvar(`hc${l}_mean${s}`,["mean",{color:"#777",id:"mean",width:2,value:h=mean(a[i[e]],t),label:{text:h.toFixed(Math.max(0,o[s]))},dashStyle:"shortdash",zIndex:999}])+highcharts(l+s,["histogram","areaSpline"],`{ series: [\n\t\t\t\t\t{ name: '${n[e]}', showInLegend: false, data:${JSON.stringify(histoSpline.bin(a[i[e]],t).map(e=>[e.mid,e.f]))}, color:Highcharts.getOptions().colors[${s}] },\n\t\t\t\t\t{ type: 'line', visible: false, color: '#777', name: 'Mean', dashStyle: 'shortdash', marker:{enabled:false}, events:{legendItemClick:function(e){if(this.visible){this.chart.xAxis[0].removePlotLine(hc${l}_mean${s}[0])}else{this.chart.xAxis[0].addPlotLine(hc${l}_mean${s}[1])}}} }\n\t\t\t\t] }`)}),m+=highchartsReflow(e["y[]"].map((e,a)=>l+a));return{title:"Area Spline Chart",vars:h,body:r+m}};