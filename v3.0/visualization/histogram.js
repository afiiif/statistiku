importScripts("../v3.0/utils.js");export const index=(e,t,a,i,s,n)=>{const h=Date.now();let r=e["y[]"].map(e=>s[e]).join(", "),l=ร(t[0].length,r,e.g.length?`by <b>${s[e.g]}</b>`:""),o=e["y[]"].map(e=>!t[i[e]].some(e=>null===e||isNaN(e))&&!n.find(t=>t[0]==s[e])&&สน(mean(t[i[e]],a))),m="";for(let t=0,a=o.length;t<a;t++)if(!1===o[t])return{error:`Invalid variable: <b class="text-warning">${s[e["y[]"][t]]}</b> contains non-numeric value`+shake("y[]")};var c=["sqrt","sturges","rice"][e.i];if(e.g.length){var g=t[i[e.g]].unq();if(g.length>100)return{error:`Invalid group: <b class="text-warning">${s[e.g]}</b> contains more than 100 unique values`+shake("g")};e["y[]"].forEach((r,l)=>{let d=void 0,v=t[i[r]].min(),f=t[i[r]].max(),$=histo.k(t[i[r]],a,c);m+=(l?"<hr>":"")+`<h6>${s[r]} <span class="fw-300">by ${s[e.g]}</span></h6>`+gvar(`hc${h}_mean${l}`,["mean",{color:"#777",id:"mean",width:2,value:d=mean(t[i[r]],a),label:{text:d.toFixed(Math.max(0,o[l]))},dashStyle:"shortdash",zIndex:999}])+highcharts(h+l,["histogram","histogramStacked"],"{ series: ["+split(t,i[e.g]).map((t,a)=>`{ name: "${vlabel(g[a],n,s[e.g])}", data:${JSON.stringify(histo.bin(t[i[r]],t[i[e.weight]],$,v,f).map(e=>[e.mid,e.f]))}, color:Highcharts.getOptions().colors[${a}] }`).join(",")+`,{ type: 'line', visible: false, color: '#777', name: 'Overall Mean', dashStyle: 'shortdash', marker:{enabled:false}, events:{legendItemClick:function(e){if(this.visible){this.chart.xAxis[0].removePlotLine(hc${h}_mean${l}[0])}else{this.chart.xAxis[0].addPlotLine(hc${h}_mean${l}[1])}}} }`+"] }")}),m+=highchartsReflow(e["y[]"].map((e,t)=>h+t))}else e["y[]"].forEach((e,n)=>{let r=void 0;m+=(n?"<hr>":"")+`<h6>${s[e]}</h6>`+gvar(`hc${h}_mean${n}`,["mean",{color:"#777",id:"mean",width:2,value:r=mean(t[i[e]],a),label:{text:r.toFixed(Math.max(0,o[n]))},dashStyle:"shortdash",zIndex:999}])+highcharts(h+n,["histogram"],`{ series: [\n\t\t\t\t\t{ showInLegend: false, data:${JSON.stringify(histo.bin(t[i[e]],a,c).map(e=>[e.mid,e.f]))}, color:Highcharts.getOptions().colors[${n}] },\n\t\t\t\t\t{ type: 'line', visible: false, color: '#777', name: 'Mean', dashStyle: 'shortdash', marker:{enabled:false}, events:{legendItemClick:function(e){if(this.visible){this.chart.xAxis[0].removePlotLine(hc${h}_mean${n}[0])}else{this.chart.xAxis[0].addPlotLine(hc${h}_mean${n}[1])}}} }\n\t\t\t\t] }`)}),m+=highchartsReflow(e["y[]"].map((e,t)=>h+t));return{title:"Histogram",vars:r,body:l+m}};