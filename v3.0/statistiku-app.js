var $hot=$("#hot"),$toolbar=$("#toolbar"),$ico={undo:$("[do=undo]"),redo:$("[do=redo]"),header:$("[do=header]"),weight:$("[do=weight]"),filter:$("[do=filter]"),vlabels:$("[do=vlabels]"),nonEmpty:$("[do=clear],[do=weight],[do=filter],[do=transpose],[do=compute],[do=export]")},$vlabels=$("#vlabels"),$outputToggle=$("#output-toggle"),$outputMenu=$("#output-menu"),$output=$("#output"),$history=$("#history"),$method=$("#method"),$analyzeForm=$("#analyze-form"),$submitBtn=$("#submit-btn"),$dataEditorH=$("#data-editor-tab-header"),$customScript=$("#custom-script"),$customScriptF=$("#custom-script-form"),$customScriptH=$("#custom-script-tab-header"),data=[[]],hot,hotVars=[],header=!1,weight=-1,filter=[],data2=[[]],hot2,outputId=0,customScript,customScriptF;const SERVER={app:"app"};$(()=>{hot=new Handsontable(document.getElementById("hot"),{data:data,minCols:25,minRows:50,minSpareCols:1,minSpareRows:1,colHeaders:t=>{let e=weight==t?'<i class="fas fa-balance-scale fa-sm ml-1 text-blue" title="Weight" data-toolbar=".fa-balance-scale"></i>':"",a=header&&data[0][t]||"VAR"+(t+1);return"VAR"+(t+1)+(data2.find(t=>t[0]==a)?'<i class="fas fa-tag fa-sm ml-1 text-blue" title="Labelled" data-toolbar=".fa-tag"></i>':"")+e},rowHeaders:!0,colWidths:76,manualColumnResize:!0,manualRowResize:!0,contextMenu:!0,maxCols:1e7,maxRows:1e7,autoWrapCol:!1,autoWrapRow:!1,wordWrap:!1}),hot2=new Handsontable(document.getElementById("hot2"),{data:data2,minCols:3,minRows:50,minSpareRows:1,colHeaders:["Variable","Value","Label"],rowHeaders:!0,stretchH:"last",colWidths:[140,64],manualColumnResize:!0,manualRowResize:!0,contextMenu:!0,maxRows:1e5,columns:[{type:"dropdown",source:[]},{},{}]}),hot.addHook("afterChange",function(){hotChange()}),hot.addHook("afterUndo",function(){$ico.redo.toggleClass("off",!hot.isRedoAvailable())}),hot.addHook("afterRedo",function(){$ico.undo.toggleClass("off",!hot.isUndoAvailable())}),hot.addHook("afterRemoveCol",function(){hotChange()}),hot.addHook("afterRemoveRow",function(){hotChange()}),$hot.on("drag dragstart dragend dragover dragenter dragleave drop",function(t){t.preventDefault(),t.stopPropagation()}).on("dragover dragenter",function(){$hot.addClass("dropzone")}).on("dragleave dragend drop",function(){$hot.removeClass("dropzone")}).on("drop",function(t){t.originalEvent.dataTransfer.files[0]&&beforeUpload(t.originalEvent.dataTransfer.files[0])}).on("click",".colHeader.cornerHeader.filtered",function(){modal("Filter Setting",'<a class="border py-3 pr-3 pl-2 dropdown-item d-flex align-items-center mb-2 remove-filtered-data"><span class="fa-stack mr-2 ml-1"><i class="fas fa-trash fa-stack-1x fa-lg"></i></span>Remove Filtered Data from Data Editor</a><a class="border py-3 pr-3 pl-2 dropdown-item d-flex align-items-center clear-filter"><span class="fa-stack mr-2 ml-1"><i class="fas fa-filter fa-stack-1x"></i><i class="fas fa-ban fa-stack-2x fa-rotate-270 text-danger"></i></span>Clear Filter</a>',null,["d-none"],["mr-0"],"modal-sm")}).on("click",".colHeader:not(.cornerHeader)",function(t){hot.isEmptyCol(i=hot.getSelected()[0][1])||t.target!==this||($(".colHeader.columnSorting").not(this).removeClass("columnSorting ascending descending"),$(this).hasClass("columnSorting")?hotSort(i,$(this).toggleClass("ascending descending").hasClass("ascending")):hotSort(i,null!==$(this).addClass("columnSorting ascending")))}),$customScript.on("drag dragstart dragend dragover dragenter dragleave drop",function(t){t.preventDefault(),t.stopPropagation()}).on("dragover dragenter",function(){$customScript.addClass("dropzone")}).on("dragleave dragend drop",function(){$customScript.removeClass("dropzone")}).on("drop",function(t){let e=t.originalEvent.dataTransfer.files[0];if(e)if(window.File&&window.FileReader&&window.FileList&&window.Blob){var a=new FileReader;a.readAsText(e),a.onload=function(t){customScript.setValue(t.target.result)},a.onerror=function(){hotLoading(`Unable to read ${e.name}`,1)}}else notif("The File APIs are not fully supported in this browser")}),$customScriptF.on("drag dragstart dragend dragover dragenter dragleave drop",function(t){t.preventDefault(),t.stopPropagation()}).on("dragover dragenter",function(){$customScriptF.addClass("dropzone")}).on("dragleave dragend drop",function(){$customScriptF.removeClass("dropzone")}).on("drop",function(t){let e=t.originalEvent.dataTransfer.files[0];if(e)if(window.File&&window.FileReader&&window.FileList&&window.Blob){var a=new FileReader;a.readAsText(e),a.onload=function(t){customScriptF.setValue(t.target.result)},a.onerror=function(){hotLoading(`Unable to read ${e.name}`,1)}}else notif("The File APIs are not fully supported in this browser")}),$toolbar.on("click","[do=open]:not(.off)",function(){modal("Open Data",'<div class="text-blue mb-1 fz-14 fw-600">Open local file <span class="d-inline-block ml-sm-1 fw-400 fz-11 text-muted">(.csv, .xls, .xlsx, .data, .dbf)</span></div>\n\t\t\t<a class="dropdown-item border p-3 open-file"><i class="fas fa-file fa-lg mr-2 text-blue"></i>Browse file...</a>\n\t\t\t<div class="text-muted my-2 pt-2 pb-1">Or</div>\n\t\t\t<div class="text-blue mb-1 fz-14 fw-600">Open from URL <span class="d-inline-block ml-sm-1 fw-400 fz-11 text-muted">(.csv)</span></div>\n\t\t\t<div class="input-group mb-1">\n\t\t\t\t<input type="text" class="form-control form-control-sm data-source" placeholder="Input URL here..." aria-label="Input URL here...">\n\t\t\t\t<div class="input-group-append"><button class="btn btn-sm btn-primary open-url" type="button">Get Data</button></div>\n\t\t\t</div>',null,["d-none"])}).on("click","[do=undo]:not(.off)",function(){hot.undo()}).on("click","[do=redo]:not(.off)",function(){hot.redo()}).on("click","[do=clear]:not(.off)",function(){hot.clear(),hot.deselectCell()}).on("click","[do=header]:not(.off)",function(){$hot.toggleClass("custom-header"),header=$(this).toggleClass("on").hasClass("on"),hotRowHeaderUpdate(),hotVarsUpdate()}).on("click","[do=vlabels]:not(.off)",function(){hot2.updateSettings({columns:[{type:"dropdown",source:hotVars.map(t=>t.name),validator:(t,e)=>e(null===t||""===t||hotVars.map(t=>t.name).includes(t))},{},{}]}),hot2.validateCells(),$vlabels.toggle(),hot.render(),$(this).toggleClass("on",!hot2IsEmpty()).toggleClass("active").parent().toggleClass("disabled")}).on("click","[do=weight]:not(.off)",function(){weight>=0&&hot.isEmptyCol(weight)&&hotWeight(-1);let t='<select class="selectpicker mt-2" name="weight" data-width="100%" data-live-search="true">'+`<option value="-1" ${null===weight?"selected":""}>None</option>`+hotVars.map(t=>`<option value="${t.i}" ${t.i==weight?"selected":""}>${t.name}</option>`).join("")+"</select>";modal("Weight","Weight cases by:"+t,null,["update-weight","Save"],void 0,"modal-sm").find(".selectpicker").selectpicker("render")}).on("click","[do=filter]:not(.off)",function(){let t=`Rule:<div class="custom-form-input mt-1">${filterGetDiv().join("")}<span contenteditable></span></div><div><div>Variable:<div class="custom-form-var">${hotVars.map(t=>`<div data-val="${t.i}" data-n="${t.name}">${t.name}</div>`).join("")}</div></div><div>Operator:<div class="custom-form-operator"><button data-val="=" class="btn btn-light"><i class="fas fa-equals"></i></button><button data-val="!=" class="btn btn-light"><i class="fas fa-not-equal"></i></button><button data-val="(" class="btn btn-light"><b>(</b></button><button data-val=")" class="btn btn-light"><b>)</b></button><br><button data-val="<" class="btn btn-light"><i class="fas fa-less-than"></i></button><button data-val=">" class="btn btn-light"><i class="fas fa-greater-than"></i></button><button data-val="&" class="btn btn-light"><small>AND</small></button><button data-val="|" class="btn btn-light"><small>OR</small></button><br><button data-val="<=" class="btn btn-light"><i class="fas fa-less-than-equal"></i></button><button data-val=">=" class="btn btn-light"><i class="fas fa-greater-than-equal"></i></button></div></div></div>`;modal("Filter Cases",t,null,["filter","Save"],void 0,"custom-form").data("shown",function(){let t=$(".custom-form-input > span");t.focus().keyup(function(e){32===e.keyCode&&customFormChange(t,$(this).text().slice(0,-1))}).keydown(function(e){""==$(this).text()&&8==e.keyCode&&$(this).prev().remove(),13==e.keyCode&&(e.preventDefault(),customFormChange(t,$(this).text()))}),$(".custom-form").click(()=>{t.focus()}),$(".custom-form-var > [data-val]").click(function(){t.before(`<div data-val="${$(this).data("val")}" data-type="v">${$(this).html()}</div>`)}),$(".custom-form-operator > [data-val]").click(function(){t.before(`<div data-val="${$(this).data("val")}" data-type="o" data-html='${$(this).html()}'>${$(this).html()}</div>`)})})}).on("click","[do=transpose]:not(.off)",function(){hot.loadData(data=transpose(data))}).on("click","[do=compute]:not(.off)",function(){let t=`Formula:<div class="custom-form-input mt-1"><span contenteditable></span></div><div><div>Variable:<div class="custom-form-var">${hotVars.map(t=>`<div data-val="${t.i}" data-n="${t.name}">${t.name}</div>`).join("")}</div></div><div>Operator:<div class="custom-form-operator"><button data-val="=" class="btn btn-light"><i class="fas fa-equals"></i></button><button data-val="!=" class="btn btn-light"><i class="fas fa-not-equal"></i></button><button data-val="(" class="btn btn-light"><b>(</b></button><button data-val=")" class="btn btn-light"><b>)</b></button><br><button data-val="<" class="btn btn-light"><i class="fas fa-less-than"></i></button><button data-val=">" class="btn btn-light"><i class="fas fa-greater-than"></i></button><button data-val="&" class="btn btn-light"><small>AND</small></button><button data-val="|" class="btn btn-light"><small>OR</small></button><br><button data-val="<=" class="btn btn-light"><i class="fas fa-less-than-equal"></i></button><button data-val=">=" class="btn btn-light"><i class="fas fa-greater-than-equal"></i></button></div></div></div><div class="custom-form-operator mt-3 d-flex"><button data-val="+" class="btn btn-light"><i class="fas fa-plus"></i></button><button data-val="-" class="btn btn-light"><i class="fas fa-minus"></i></button><button data-val="*" class="btn btn-light"><i class="fas fa-times"></i></button><button data-val="/" class="btn btn-light"><i class="fas fa-divide"></i></button><button data-val="^" class="btn btn-light"><small>^</small></button><button data-val="log" class="btn btn-light"><small class="math">LOG (</small></button><button data-val="abs" class="btn btn-light"><small class="math">ABS (</small></button><button data-val="if" class="btn btn-light border-warning"><small class="condition">IF (</small></button><button data-val="then" class="btn btn-light border-warning"><small class="condition">) THEN (</small></button><button data-val="else" class="btn btn-light border-warning"><small class="condition">) ELSE (</small></button></div><div class="alert alert-info mb-0 mt-3 px-3" role="alert"><i class="fas fa-info-circle fa-lg mr-2"></i>New variable will be placed after <b>${hotVars[hotVars.length-1].name}</b></div>`;modal("Compute Variable",t,null,["compute","Compute Variable"],void 0,"custom-form").data("shown",function(){let t=$(".custom-form-input > span");t.focus().keyup(function(e){32===e.keyCode&&customFormChange(t,$(this).text().slice(0,-1))}).keydown(function(e){""==$(this).text()&&8==e.keyCode&&$(this).prev().remove(),13==e.keyCode&&(e.preventDefault(),customFormChange(t,$(this).text()))}),$(".custom-form").click(()=>{t.focus()}),$(".custom-form-var > [data-val]").click(function(){t.before(`<div data-val="${$(this).data("val")}" data-type="v">${$(this).html()}</div>`)}),$(".custom-form-operator > [data-val]").click(function(){t.before(`<div data-val="${$(this).data("val")}" data-type="o" data-html='${$(this).html()}'>${$(this).html()}</div>`)})})}).on("click","[do=export]:not(.off)",function(){modal("Export Data",'<a class="border py-3 pr-3 pl-2 dropdown-item d-flex align-items-center mb-2 export-data-csv"><i class="fas fa-file-csv fa-2x fa-fw mr-1 text-muted"></i>CSV File<span class="text-muted ml-1">(.csv)</span></a><a class="border py-3 pr-3 pl-2 dropdown-item d-flex align-items-center mb-2 export-data-excel"><i class="fas fa-file-excel fa-2x fa-fw mr-1 text-success"></i>Excel File<span class="text-success ml-1">(.xlsx)</span></a><a class="border py-3 pr-3 pl-2 dropdown-item d-flex align-items-center export-data-statistiku"><i class="fas fa-file-alt fa-2x fa-fw mr-1 text-blue"></i>Statistiku File<span class="text-blue ml-1">(.statistiku)</span></a>',null,["d-none"],["mr-0"],"modal-sm")}),$modal.on("click",".open-file",function(){$modal.modal("hide"),$("#open-file").click()}).on("click",".open-url",function(){let t=$modal.find(".data-source");(url=t.val())?($modal.modal("hide"),hotLoading("Opening URL..."),openData(url)):t.addClass("is-invalid")}).on("click",".delete-output",function(){deleteOutput($(this).data("x"),$(this).data("id")),$modal.modal("hide")}).on("click",".upload-and-overwrite",function(){readFile($modalBtn[0].data("file")),$modal.modal("hide")}).on("click",".upload-and-prepend",function(){insertFile($modalBtn[0].data("file")),$modal.modal("hide")}).on("click",".upload-and-append",function(){insertFile($modalBtn[0].data("file"),1),$modal.modal("hide")}).on("click",".update-weight",function(){hotWeight($modal.find("select[name=weight]").val()),$modal.modal("hide"),weight>=0&&notif(`Weighted by ${hotVars.find(t=>t.i==weight).name}`)}).on("click",".filter",function(){if(customFormChange($a=$(".custom-form-input > span"),$a.text()),$(".custom-form-input > .text-danger").length)return $(".custom-form-input").addClass("border-danger");$(".custom-form-input").removeClass("border-danger");let t=filter.slice(0);filter=[],$(".custom-form-input > div").each((t,e)=>{filter.push($(e).data())}),customFormValid(filter)?($modal.modal("hide"),notif("Filter updated"),hotRowHeaderUpdate()):(filter=t.slice(0),$(".custom-form-input").addClass("border-danger")),$ico.filter.toggleClass("on",filter.length>0)}).on("click",".compute",function(){if(customFormChange($a=$(".custom-form-input > span"),$a.text()),$(".custom-form-input > .text-danger").length)return $(".custom-form-input").addClass("border-danger");if(0===$(".custom-form-input > div").length)return $(".custom-form-input").addClass("border-danger");$(".custom-form-input").removeClass("border-danger");let newVar=[];if($(".custom-form-input > div").each((t,e)=>{newVar.push($(e).data())}),customFormValid(newVar)){let i=hotVars[hotVars.length-1].i+1;data.forEach((y,j)=>{if(!hot.isEmptyRow(j)&&(!header||j))try{data[j][i]=Number(eval(getExpression(newVar)).toFixed(12))}catch(e){data[j][i]=eval(getExpression(newVar))}}),hot.loadData(data),$modal.modal("hide"),notif("Compute new variable success")}else $(".custom-form-input").addClass("border-danger");console.info(getExpression(newVar))}).on("click",".clear-filter",function(){hotClearFilter(),$modal.modal("hide"),notif("Filter cleared")}).on("click",".remove-filtered-data",function(){modal("Remove Filtered Data",'All filtered data will be removed.<div class="text-danger">You cannot undo this action.</div>',null,["remove-filtered-data-anyway","Remove Anyway"],void 0,"modal-sm")}).on("click",".remove-filtered-data-anyway",function(){hot.loadData(data=data.filter((y,j)=>header&&0===j||eval(getExpression(filter)))),filter=[],$ico.filter.removeClass("on"),$modal.modal("hide"),hotRowHeaderUpdate(),notif("Remove filtered data success")}).on("click",".export-data-csv",function(){$modal.modal("hide");let t="sep=,\n"+data.filter((t,e)=>!hot.isEmptyRow(e)).map(t=>t.filter((t,e)=>!hot.isEmptyCol(e)).map(t=>t.toString().indexOf(",")>-1?'"'+t+'"':t).join(",")).join("\n"),e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),e.setAttribute("download","Export "+moment().format("YYYYMMDD-HHmm")+".csv"),document.body.appendChild(e),e.click(),document.body.removeChild(e)}).on("click",".export-data-excel",function(){$modal.modal("hide"),exportToExcel([{data:data,name:"Data"},{data:[["Variable","Value","Label"],...data2],name:"Value Labels"}],"Export "+moment().format("YYYYMMDD-HHmm"))}).on("click",".export-data-statistiku",function(){$modal.modal("hide");let t=JSON.stringify({data:data,data2:data2,header:header,filter:filter,weight:weight}),e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),e.setAttribute("download","Export "+moment().format("YYYYMMDD-HHmm")+".statistiku"),document.body.appendChild(e),e.click(),document.body.removeChild(e)}),$(document).on("click","[data-toolbar]",function(){$toolbar.find($(this).data("toolbar")).click()}),$("#open-file").change(function(t){beforeUpload(t.target.files[0])}),$submitBtn.click(function(){if($submitBtn.hasClass("disabled"))return;let t={weight:weight>=0?weight:null},e=[],a=!0,o="";$analyzeForm.find("[name]:not(.custom-control-input:not(:checked))").each((l,i)=>{let s=$(i),n=s.val();s.data("req")&&0===n.length?(s.closest("fieldset").effect("shake",{distance:10}),a=!1):s.data("minOptions")&&n.length<s.data("minOptions")&&(s.closest("fieldset").effect("shake",{distance:10}),a=!1,o="Select at least 2 variables"),s.hasClass("is-variable")&&(Array.isArray(n)?e=e.concat(n):""!==n&&e.push(n)),t[s.prop("name")]=n}),a?submitForm([$method.find(":selected").closest("optgroup").data("category"),$method.find(":selected").val()],t,e):(o&&notif(o),$submitBtn.prev().show())}),$method.on("shown.bs.select",function(){$method.selectpicker("refresh")}),$outputMenu.on("click",".dropdown-item",function(){goToOutput($(this).index())}).on("click",".fa-times",function(){modal("Delete Output",`Are you sure you want to delete <b>${$(this).prev().html()}</b>?`,{x:$(this).parent().index(),id:$(this).parent().data("output-id")},["delete-output btn-danger bg-danger"])}),$history.on("click","[data-output-id]:not(.disabled)",function(){$outputMenu.find(`[data-output-id="${$(this).data("output-id")}"]`).click()}),window.onbeforeunload=function(){if(!hotIsEmpty())return"Are you sure you want to leave?"},customScript=ace.edit("custom-script"),customScript.setTheme("ace/theme/monokai"),customScript.setShowPrintMargin(!1),customScript.session.setMode("ace/mode/javascript"),customScriptF=ace.edit("custom-script-form"),customScriptF.setTheme("ace/theme/monokai"),customScriptF.setShowPrintMargin(!1),customScriptF.session.setMode("ace/mode/json"),(url=urlParams.get("data"))&&openData(url),1==urlParams.get("header")&&$ico.header.click(),INITIAL_ANALYSIS_METHOD.value?selectMethod(INITIAL_ANALYSIS_METHOD.value):urlParams.get("method")&&selectMethod(urlParams.get("method"))});const transpose=t=>t[0].map((e,a)=>t.map(t=>t[a])),validExt=(t,e)=>t.substr(t.lastIndexOf(".")+1)===e,goToOutput=t=>{$outputToggle.html($outputMenu.children().removeClass("active").eq(t).addClass("active").find("div").html()+'<div class="tab-dropdown-toggle-btn"></div>'||"Output"),$output.children().hide().eq(t).show()},addOutput=(t,e,a)=>{addHistory(`<div data-output-id="${++outputId}"><span>${t}</span><div class="text-blue">${a}</div></div>`),$output.append(`<div class="output">${e}</div>`),$outputMenu.append(`<div class="dropdown-item" data-output-id="${outputId}"><div title="${t} (${a})"><span>Output ${outputId}:</span> ${t}</div><i class="fas fa-fw fa-times" title="Delete"></i></div>`).find(">:last-child").click(),$outputToggle.toggleClass("single",$output.children().length<2)},deleteOutput=(t,e)=>{$output.children().eq(t).remove(),$outputMenu.children().eq(t).remove(),goToOutput((t||1)-1),$outputToggle.toggleClass("single",$output.children().length<2),$history.find(`[data-output-id="${e}"]`).addClass("disabled").attr("title","Deleted").parent().next().addClass("disabled")},addHistory=t=>{$history.append(`<div><div class="time" title="${moment().format("D MMMM YYYY HH:mm:ss")}">${moment().format("HH:mm")}</div><div>${t}</div></div>`)},beforeUpload=t=>{t.size>1e9?notif("Cannot upload file more than 1 GB"):hotIsEmpty()?readFile(t):validExt(t.name,"statistiku")||validExt(t.name,"dbf")?modal("Overwrite Data","The data editor is not empty.<br>Are you sure you want to overwrite the data?",{file:t},["upload-and-overwrite","Yes"],void 0,"modal-sm"):validExt(t.name,"csv")||validExt(t.name,"xls")||validExt(t.name,"xlsx")?modal("Data Editor is Not Empty",'<div class="pb-1">The data editor is not empty.<br>Do you want to overwrite or insert the data?</div>\n\t\t\t<a class="border py-2 pr-3 pl-2 dropdown-item mt-2 upload-and-overwrite"><i class="fas fa-chevron-circle-right mr-2"></i>Overwrite the data</a>\n\t\t\t<a class="border py-2 pr-3 pl-2 dropdown-item my-2 upload-and-prepend"><i class="fas fa-chevron-circle-right mr-2"></i>Insert above</a>\n\t\t\t<a class="border py-2 pr-3 pl-2 dropdown-item upload-and-append"><i class="fas fa-chevron-circle-right mr-2"></i>Insert below</a>',{file:t},["d-none"],void 0,"modal-sm"):readFile(t)},readFile=t=>{if(window.File&&window.FileReader&&window.FileList&&window.Blob){var e=new FileReader;if(validExt(t.name,"csv")||validExt(t.name,"data"))hotLoading("Reading CSV file..."),e.readAsText(t),e.onload=function(e){let a=e.target.result;hot.loadData(data=$.csv.toArrays(a)),hotLoading("Data opened successfully",1),addHistory(`Open CSV file<div class="text-blue">${t.name}</div>`)},e.onerror=function(){hotLoading(`Unable to read ${t.name}`,1)};else if(validExt(t.name,"xls")||validExt(t.name,"xlsx")){hotLoading("Reading Excel file..."),(e=new FileReader).readAsArrayBuffer(t),e.onload=function(e){let a=XLSX.read(new Uint8Array(e.target.result),{type:"array"}),o=XLSX.utils.sheet_to_csv(a.Sheets[a.SheetNames[0]]);hot.loadData(data=$.csv.toArrays(o)),hotLoading("Data opened successfully",1),addHistory(`Open Excel file<div class="text-blue">${t.name}</div>`)},e.onerror=function(){hotLoading(`Unable to read ${t.name}`,1)}}else validExt(t.name,"statistiku")?(hotLoading("Reading Statistiku file..."),e.readAsText(t),e.onload=function(e){openStatistiku(JSON.parse(e.target.result)),hotLoading("Data opened successfully",1),addHistory(`Open Statistiku file<div class="text-blue">${t.name}</div>`)},e.onerror=function(){hotLoading(`Unable to read ${t.name}`,1)}):notif("Upload error: Invalid file extension")}else notif("The File APIs are not fully supported in this browser")},insertFile=(t,e=!1)=>{if(window.File&&window.FileReader&&window.FileList&&window.Blob){var a=new FileReader;if(validExt(t.name,"csv"))hotLoading("Reading CSV file..."),a.readAsText(t),a.onload=function(a){let o=a.target.result;e?hot.loadData(data=hotGetDataNotEmptyRow().concat($.csv.toArrays(o))):hot.loadData(data=$.csv.toArrays(o).concat(data)),hotLoading("Data opened successfully",1),addHistory(`Open CSV file<div class="text-blue">${t.name}</div>`)},a.onerror=function(){hotLoading(`Unable to read ${t.name}`,1)};else if(validExt(t.name,"xls")||validExt(t.name,"xlsx")){hotLoading("Reading Excel file..."),(a=new FileReader).readAsArrayBuffer(t),a.onload=function(a){let o=XLSX.read(new Uint8Array(a.target.result),{type:"array"}),l=XLSX.utils.sheet_to_csv(o.Sheets[o.SheetNames[0]]);e?hot.loadData(data=hotGetDataNotEmptyRow().concat($.csv.toArrays(l))):hot.loadData(data=$.csv.toArrays(l).concat(data)),hotLoading("Data opened successfully",1),addHistory(`Open Excel file<div class="text-blue">${t.name}</div>`)},a.onerror=function(){hotLoading(`Unable to read ${t.name}`,1)}}else notif("Upload error: Invalid file")}else notif("The File APIs are not fully supported in this browser")},openData=t=>{$.ajax({url:t,type:"GET",cache:!1,success:e=>{if(t.endsWith(".statistiku"))openStatistiku(JSON.parse(e)),hotLoading("Data opened successfully",1),addHistory(`Open data from URL:<br><a href="${t}" target="_blank" class="d-block"><i class="fas fa-link mr-2"></i>${t}</a>`);else try{let a=$.csv.toArrays(e);a.constructor===Array?(hot.loadData(data=a),hotLoading("Get online data success",1),addHistory(`Open data from URL:<br><a href="${t}" target="_blank" class="d-block"><i class="fas fa-link mr-2"></i>${t}</a>`)):hotLoading("Invalid CSV",1)}catch(t){hotLoading("Invalid CSV",1)}},error:t=>{hotLoading("Failed to get data",1)}})},openStatistiku=t=>{try{$ico.header.toggleClass("on",header=t.header),$hot.toggleClass("custom-header",header),hot.loadData(data=t.data),hot2.loadData(data2=t.data2),filter=t.filter,$ico.filter.toggleClass("on",filter.length>0),hotRowHeaderUpdate(),hotWeight(t.weight),$ico.vlabels.toggleClass("on",!hot2IsEmpty())}catch(t){hotLoading("Invalid Statistiku File",1)}},customFormChange=(t,e)=>{if(""===$.trim(e))return t.html("");'"'===e[0]&&e[1]&&'"'===e[e.length-1]&&customFormChange(t,e.substring(1,e.length-1)),"`"===e[0]&&"`"!==e[1]&&"`"===e[e.length-1]?(e=e.substring(1,e.length-1),t.html("").before(`<div data-val="${e}" data-type="s">${e}</div>`)):(t2=e.replace(/"/g,'\\"'),(a=$(`.custom-form-operator > [data-val="${t2}"]`)[0])?$(a).click():(a=$(`.custom-form-var > [data-n="${t2}"]`)[0])?$(a).click():$.isNumeric(e)?t.before(`<div data-val="${t2}" data-type="n">${e}</div>`):t.before(`<div data-type="t" data-val="${e}">"${e}"</div>`),t.html(""))},customFormValid=arr=>{try{return eval(getExpression(arr).replace(/data\[j\]/g,"data[0]")),!0}catch(t){return!1}},getExpression=t=>{return t.map(t=>"v"===t.type?`(isNaN(data[j][${t.val}])?data[j][${t.val}]:parseFloat(data[j][${t.val}]))`:"o"===t.type?"="===t.val?"==":"log"===t.val?"Math.log(":"^"===t.val?"**":"abs"===t.val?"Math.abs(":"if"===t.val?"(":"then"===t.val?"?":"else"===t.val?":":t.val:"n"===t.type?t.val:"t"===t.type?`"${t.val}"`:"s"===t.type?t.val:void 0).join("")},filterGetDiv=()=>{try{return filter.map(t=>"v"===t.type?`<div data-val="${t.val}" data-type="v">${hotVars.find(e=>e.i===t.val).name}</div>`:"o"===t.type?`<div data-val="${t.val}" data-type="o" data-html='${t.html}'>${t.html}</div>`:"n"===t.type?`<div data-val="${t.val}" data-type="n">${t.val}</div>`:"t"===t.type?`<div data-val="${t.val}" data-type="t">"${t.val}"</div>`:"s"===t.type?`<div data-val="${t.val}" data-type="s">${t.val}</div>`:void 0)}catch(t){return hotClearFilter(),[]}},hotRowHeaderUpdate=()=>{filter.length?($(".colHeader.cornerHeader").addClass("filtered").attr("title","Filter Setting"),header?hot.updateSettings({fixedRowsTop:1,rowHeaders:j=>0===j?'<span title="Header / Variable Name" class="text-blue"><i class="fas fa-heading fa-sm px-1"></i><i class="fas fa-caret-right fa-sm"></i>':eval(getExpression(filter))?j:`<s class="text-danger">&nbsp; ${j} &nbsp;</s>`}):hot.updateSettings({fixedRowsTop:0,rowHeaders:j=>eval(getExpression(filter))?j+1:`<s class="text-danger">&nbsp; ${j+1} &nbsp;</s>`})):($(".colHeader.cornerHeader").removeClass("filtered").attr("title",""),header?hot.updateSettings({fixedRowsTop:1,rowHeaders:t=>t||'<span title="Header / Variable Name" class="text-blue"><i class="fas fa-heading fa-sm px-1"></i><i class="fas fa-caret-right fa-sm"></i>'}):hot.updateSettings({fixedRowsTop:0,rowHeaders:!0}))},hotChange=()=>{$(".colHeader.columnSorting").removeClass("columnSorting ascending descending"),$ico.undo.toggleClass("off",!hot.isUndoAvailable()),$ico.redo.toggleClass("off",!hot.isRedoAvailable()),hotIsEmpty()?($ico.nonEmpty.removeClass("on").addClass("off"),weight=-1,filter=[],$analyzeForm.addClass("disabled"),$submitBtn.prev().hide()):($ico.nonEmpty.removeClass("off"),$analyzeForm.removeClass("disabled")),hotVarsUpdate()},hotVarsUpdate=()=>{let t=hotVars.slice(0);hotVars=[];for(let t=0,e=data[0].length;t<e;t++)hot.isEmptyCol(t)||hotVars.push({i:t,name:header&&data[0][t]||"VAR"+(t+1)});JSON.stringify(hotVars)!=JSON.stringify(t)&&selectMethod($method.find(":selected").val())},hotWeight=t=>{$ico.weight.toggleClass("on",(weight=t)>=0),hot.render()},hotClearFilter=()=>{filter=[],$ico.filter.removeClass("on"),hotRowHeaderUpdate()},hotSort=(t,e,a=0)=>{if(a)for(data.sort(function(a,o){return null===a[t]||""===a[t]?1:null===o[t]||""===o[t]?-1:isNaN(a[t])&&!isNaN(o[t])?e?-1:1:!isNaN(a[t])&&isNaN(o[t])?e?1:-1:(isNaN(a[t])||(a[t]=parseFloat(a[t])),isNaN(o[t])||(o[t]=parseFloat(o[t])),e?a[t]>o[t]?1:a[t]<o[t]?-1:0:a[t]>o[t]?-1:a[t]<o[t]?1:0)}),j=data.length-1;j>=0;j--)hot.isEmptyRow(j)&&data.push(data.splice(j,1)[0]);else{if(header){let a=data[0];data.shift(),hotSort(t,e,1),data.unshift(a)}else hotSort(t,e,1);hot.render(),hot.clearUndo(),$ico.undo.toggleClass("off",!hot.isUndoAvailable()),$ico.redo.toggleClass("off",!hot.isRedoAvailable())}},hotLoading=(t,e=!1)=>{e?($hot.removeClass("loading"),notif(t,2)):($hot.addClass("loading"),notif(t,1))},hotIsEmpty=()=>hot.countCols()===hot.countEmptyCols()&&hot.countRows()===hot.countEmptyRows(),hot2IsEmpty=()=>hot2.countCols()===hot2.countEmptyCols()&&hot2.countRows()===hot2.countEmptyRows(),hotGetData=()=>{let dataFiltered=null;return dataFiltered=header?filter.length?data.filter((y,j)=>0!=j&&eval(getExpression(filter))):data.slice(1):filter.length?data.filter((y,j)=>eval(getExpression(filter))):data,dataFiltered},hotGetDataNotEmptyRow=()=>data.filter((t,e)=>!hot.isEmptyRow(e)),exportToExcel=(t,e)=>{let a=XLSX.utils.book_new();t.forEach(t=>{let e=XLSX.utils.aoa_to_sheet(t.data);XLSX.utils.book_append_sheet(a,e,t.name)}),XLSX.writeFile(a,e+".xlsx")},exportToCsv=(t,e)=>{let a=XLSX.utils.book_new(),o=XLSX.utils.aoa_to_sheet(t);XLSX.utils.book_append_sheet(a,o,"Data"),XLSX.writeFile(a,e+".csv")},app={"bar-chart":{form:[{required:1,name:"a",label:"Variable(s)",type:"select",val:["Sum of","Frequency of","Mean of"],fieldsetClass:"mb-1"},{required:1,name:"y[]",label:!1,type:"select-var"},{required:1,name:"g[]",label:"Group by",type:"select-group",options:{order:!0}},{type:"script",val:"$analyzeForm.find('[name=\"g[]\"]').change(function() { $analyzeForm.find('[name=s]').closest('label').toggle($(this).val().length>1); }).change();"},{required:1,options:[{name:"s",label:"Stacked bar"},{name:"i",label:"Plot bars horizontally"}],label:"Display",type:"switch"}]},"pie-chart":{form:[{required:1,name:"a",label:"Variable(s)",type:"select",val:["Sum of","Frequency of"],fieldsetClass:"mb-1"},{required:1,name:"y[]",label:!1,type:"select-var"},{required:1,name:"g[]",label:"Split by",type:"select-group",options:{order:!0}}]},boxplot:{form:[{required:1,name:"y[]",label:"Variable(s)",type:"select-var"},{required:0,name:"g",label:"Group by",type:"select-group"}]},histogram:{form:[{required:1,name:"y[]",label:"Variable(s)",type:"select-var"},{required:0,name:"g",label:"Group by",type:"select-group"}],conf:[{required:1,name:"i",label:"Number of Bins",type:"select",val:["Square-root choice","Sturges' formula","Rice Rule"]}]},areaspline:{form:[{required:1,name:"y[]",label:"Variable(s)",type:"select-var"},{required:0,name:"g",label:"Group by",type:"select-group"},{type:"script",val:"$analyzeForm.find('[name=g]').change(function() { $analyzeForm.find('[name=a]').closest('fieldset').toggle($(this).val()!==''); }).change();"},{required:1,options:[{name:"a",label:"Stacked area"}],label:"Display",type:"switch"}]},scatter:{form:[{required:1,name:"x",label:"X Axis",type:"select-var"},{required:1,name:"y",label:"Y Axis",type:"select-var"},{required:0,name:"g",label:"Group by",type:"select-group"}],conf:[{required:0,name:"a[]",label:"Add Variables to Tooltip",type:"select-var",max:5,header:"&nbsp;"}]},"3d-scatter":{form:[{required:1,name:"x",label:"X Axis",type:"select-var"},{required:1,name:"y",label:"Y Axis",type:"select-var"},{required:1,name:"z",label:"Z Axis",type:"select-var"}],conf:[{required:0,name:"a[]",label:"Add Variables to Tooltip",type:"select-var",max:5,header:"&nbsp;"}]},qqplot:{form:[{required:1,name:"y",label:"Variable",type:"select-var"},{required:1,name:"a",label:"Distribution",type:"select",val:["Normal","Uniform","Exponential"]}],conf:[{required:0,name:"g",label:"Group by",type:"select-group"}]},"heat-map":{form:[{required:1,name:"a",label:"Variable(s)",type:"select",val:["Sum of","Frequency of","Mean of"],fieldsetClass:"mb-1"},{required:1,name:"z[]",label:!1,type:"select-var"},{required:1,name:"x",label:"X Axis",type:"select-group"},{required:1,name:"y",label:"Y Axis",type:"select-group"}]},"packed-bubble-chart":{form:[{required:1,name:"a",label:"Variable(s)",type:"select",val:["Sum of","Frequency of","Mean of"],fieldsetClass:"mb-1"},{required:1,name:"y[]",label:!1,type:"select-var"},{required:1,name:"g[]",label:"Group by",type:"select-group",options:{order:!0}}]},sunburst:{form:[{required:1,name:"a",label:"Variable(s)",type:"select",val:["Sum of","Frequency of"],fieldsetClass:"mb-1"},{required:1,name:"y[]",label:!1,type:"select-var",max:5},{required:1,name:"g[]",label:"Split by",type:"select-group",options:{order:!0},max:4}]},"parallel-coordinates-chart":{form:[{required:1,name:"y[]",label:"Variables",type:"select-var",options:{order:!0},header:"&nbsp;",title:"Select at least 2 variables",min:2},{required:1,name:"a",label:"Line Type",type:"radio",val:["Straight","Curved"],check:1}],conf:[{required:0,name:"g",label:"Group by",type:"select-group"}]},"venn-diagram":{form:[]},"waterfall-chart":{form:[]},summary:{form:[{required:1,name:"y[]",label:"Variable(s)",type:"select-var",header:"&nbsp;"},{required:0,name:"g[]",label:"Group by",type:"select-group",max:3,options:{order:!0}}]},"pearson-correlation":{form:[{required:1,name:"y[]",label:"Variables",type:"select-var",label:"Variables",title:"Select at least 2 variables",min:2},{required:1,name:"a",label:"Test of Significance",type:"radio",val:["One-tailed","Two-tailed"],check:1},{required:1,options:[{name:"c",label:"Show scatter plot"}],label:"Additional Output",type:"check"}]},"spearman-correlation":{form:[{required:1,name:"y[]",label:"Variables",type:"select-var",label:"Variables",title:"Select at least 2 variables",min:2},{required:1,name:"a",label:"Test of Significance",type:"radio",val:["One-tailed","Two-tailed"],check:1},{required:1,options:[{name:"c",label:"Show scatter plot"}],label:"Additional Output",type:"check"}]},"one-sample-t-test":{form:[{required:1,name:"y[]",label:"Variable(s)",type:"select-var"},{required:1,name:"t",label:"Test Value",type:["input","text"],val:"0"},{required:1,name:"ci",label:"Confidence Interval",type:"range",val:{min:50,max:99.99,step:.01,val:95},header:"%"}]},anova:{form:[{required:1,name:"y[]",label:"Variable(s)",type:"select-var"},{required:1,name:"g",label:"Factor",type:"select-group",title:"Select factor"}],conf:[{required:1,options:[{name:"a",label:"Show chart"}],label:"Additional Output",type:"check"}]},"f-test":{form:[{required:1,name:"y",label:"Variable",type:"select-var"},{required:1,name:"g",label:"Factor",type:"select-group",title:"Select factor",header:"Dichotomous variable only"},{required:1,name:"ci",label:"Confidence Interval",type:"range",val:{min:50,max:99.99,step:.01,val:95},header:"%"}]},bartlett:{form:[]},regression:{form:[{required:1,name:"y",label:"Dependent Variable",type:"select-var"},{required:1,name:"x[]",label:"Independent Variable(s)",type:"select-var"}]},"qqplot-multivariate":{form:[{required:1,name:"y[]",label:"Variables",type:"select-var",label:"Variables",title:"Select at least 2 variables",min:2}]}};$(()=>{$method.change(()=>{let t=$method.find(":selected");"activeElement"in document&&document.activeElement.blur();const e=t.val();document.title=`${t.text()} · Statistiku`,window.history.replaceState(null,null,"app/"+e+location.search),selectMethod(e)})});const selectMethod=t=>{if($method.val(t),$submitBtn.prev().hide(),"custom-script"===t||"advanced-custom-script"===t){if($customScriptH.show(),$("#custom-form").toggle("advanced-custom-script"===t).prev().toggle("custom-script"===t),"advanced-custom-script"===t)try{app["advanced-custom-script"].form=JSON.parse(customScriptF.getValue()),app["advanced-custom-script"].form.push({type:"html",val:'<div class="mt-3 mb-2"><button type="button" onclick="selectMethod(\'advanced-custom-script\')" class="btn btn-link btn-block"><i class="fas fa-sync-alt mr-2"></i>Refresh Form</button></div>'})}catch(t){app["advanced-custom-script"].form=[{type:"html",val:'<div class="text-danger text-center pb-2"><i class="fas fa-ban fa-5x my-2"></i><i class="d-block">Form build failed.<br>Invalid JSON form!</i></div><div class="mt-3 mb-2"><button type="button" onclick="selectMethod(\'advanced-custom-script\')" class="btn btn-link btn-block"><i class="fas fa-sync-alt mr-2"></i>Refresh Form</button></div>'}]}}else $customScriptH.hide().prev().hasClass("active")||$dataEditorH.click();$method.selectpicker("refresh"),app.hasOwnProperty(t)?app[t].form.length?($analyzeForm.html(app[t].form.map(t=>createForm(t)).join("")+(app[t].hasOwnProperty("conf")?`<div class="conf-toggle" onclick="$(this).toggleClass('show').next().slideToggle(200)"><i class="fas fa-cog mr-2"></i>Options</div><div class="conf" style="display:none">${app[t].conf.map(t=>createForm(t)).join("")}</div>`:"")).find(".selectpicker").selectpicker("render"),$analyzeForm.find(".selectpicker").on("shown.bs.select",function(){$(this).selectpicker("refresh")})):$analyzeForm.html("advanced-custom-script"===t?'<div class="text-danger mb-4"><i>Error creating custom form...</i></div>':'<div class="text-muted mb-4"><i>Coming soon...</i></div>'):$analyzeForm.html("")},createForm=({fieldsetClass:t="",required:e,name:a,label:o,type:l,val:i,title:s,min:n,max:r,header:d,check:c,options:m})=>{if("html"===l)return i;if("hidden"===l)return`<input type="hidden" name="${a}">`;if("script"===l)return"<script>"+i+"<\/script>";if($f=`<fieldset class="${t}">`,!1!==o&&($f+=`<label class="fw-600 mb-1 text-blue">${o}:${e?"":'<span class="text-success ml-2 fw-400">(Optional)</span>'}</label>`),"select"===l&&($f+=`<select name="${a}" data-req="${e}" title="${s||""}" ${a.includes("[]")?`multiple data-max-options="${r||25}"`:""} class="selectpicker" data-width="100%">`+i.map((t,e)=>`<option value="${e}">${t}</option>`).join("")+"</select>"),"select-var"===l&&($f+=`<select name="${a}" data-req="${e}" title="${s||(a.includes("[]")?"Select 1 or more variable":"Select variable")}" ${a.includes("[]")?`multiple data-max-options="${r||25}"`:""} data-header="${d||"Numerical variable only"}" class="selectpicker is-variable" data-width="100%" data-live-search="true" ${a.includes("[]")&&n?`data-min-options="${n}"`:""}>`+hotVars.map(t=>`<option value="${t.i}">${t.name}</option>`).join("")+"</select>"),"select-group"===l&&($f+=`<select name="${a}" data-req="${e}" title="${s||(e?"Select group":"None")}" ${a.includes("[]")?`multiple data-max-options="${r||2}"`:""} data-header="${d||"Categorical variable only"}" class="selectpicker is-variable" data-width="100%" data-live-search="true" ${a.includes("[]")&&n?`data-min-options="${n}"`:""}>`+(e||a.includes("[]")?"":'<option value="">None</option>')+hotVars.map(t=>`<option value="${t.i}">${t.name}</option>`).join("")+"</select>"),"radio"===l&&($f+=i.map((t,e)=>`<label class="custom-control custom-radio"><input type="radio" name="${a}" value="${e}" ${c?c==e?"checked":"":e?"":"checked"} class="custom-control-input"><div class="custom-control-label">${t}</div></label>`).join("")),"check"===l&&($f+=m.map((t,e)=>`<label class="custom-control custom-checkbox"><input type="checkbox" name="${t.name}" ${t.check?"checked":""} class="custom-control-input"><div class="custom-control-label">${t.label}</div></label>`).join("")),"switch"===l&&($f+=m.map((t,e)=>`<label class="custom-control custom-switch"><input type="checkbox" name="${t.name}" ${t.check?"checked":""} class="custom-control-input"><div class="custom-control-label">${t.label}</div></label>`).join("")),"range"===l&&($f+=`<div class="input-group"><input name="${a}" data-req="${e}" type="number" class="form-control" placeholder="${s||""}" min="${i.min}" max="${i.max}" step="${i.step||1}" value="${i.val}"><div class="input-group-append"><span class="input-group-text fz-12">${d}</span></div></div>`),"input"===l[0]&&($f+=`<input name="${a}" data-req="${e}" type="${l[1]}" class="form-control" placeholder="${s||""}" value="${i||""}">`),("select-var"===l||"select-group"===l)&&m&&m.order){let t=a.replace("[]","Order");$f+=`\n\t\t\t\t<input type="hidden" name="${t}">\n\t\t\t\t<script>\n\t\t\t\t\t$analyzeForm.find('[name="${a}"]').change(function() {\n\t\t\t\t\t\tlet ${t} = JSON.parse('['+$analyzeForm.find('[name="${t}"]').val()+']');\n\t\t\t\t\t\t$(this).find('option').each((i,opt)=>{\n\t\t\t\t\t\t\tif ($(opt).is(':selected')) {\n\t\t\t\t\t\t\t\tif (!${t}.includes(i)) ${t}.push(i);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tif (${t}.includes(i)) ${t}.splice(${t}.indexOf(i), 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$analyzeForm.find('[name="${t}"]').val(${t}.join(','));\n\t\t\t\t\t});\n\t\t\t\t<\/script>\n\t\t\t\t`}return $f+"</fieldset>"},submitForm=([t,e],a,o)=>{weight>=0&&o.push(weight),o=o.map(t=>parseInt(t)).sort((t,e)=>t-e).filter((t,e,a)=>e===a.indexOf(t));let l=hotGetData().reduce((t,e)=>{const a=e.reduce((t,e,a)=>(o.includes(a)&&t.push(null===e||""===e||isNaN(e)?e||null:parseFloat(e)),t),[]);return a.every(t=>null===t)||t.push(a),t},[]);if(0===l.length)return notif("No data included");let i={},s={};o.forEach((t,e)=>{i[t]=e,s[t]=hotVars.find(e=>e.i==t).name});let n={appVersion:APP_VERSION,category:t,method:e,formData:a,data:l,vars:i,varNames:s,varLabels:data2.filter(t=>!t.every(t=>null===t||""===t))};"custom-script"!==e&&"advanced-custom-script"!==e||(n.script=customScript.getValue()),$submitBtn.addClass("disabled").html('<i class="fas fa-spinner fa-pulse mr-2"></i>Processing...').prev().hide();const r=new Worker("js/worker.js");r.onmessage=function(t){console.debug(t.data);const a=t.data;return a?a.error?("custom-script"===e?notif('<i class="fas fa-exclamation-triangle mr-2"></i>'+a.error):notif(a.error),$submitBtn.removeClass("disabled").html("Submit").blur()):("localhost"===window.location.hostname&&a[0]&&console.info(a[0]),"localhost"===window.location.hostname&&a[1]&&console.table(a[1]),a.title&&a.body&&a.vars?(addOutput(a.title,a.body,a.vars),notif("Analyze data success")):notif("Oops! Something went wrong"),void $submitBtn.removeClass("disabled").html("Submit").blur()):(notif("Oops! Something went wrong"),$submitBtn.removeClass("disabled").html("Submit").blur())},r.postMessage(n)},colors={primary:"#007bff",success:"#17c671",warning:"#ffb400",salmon:"#ff4169",secondary:"#5a6169",info:"#00b8d8",java:"#1adba2",royalblue:"#674eec",yellow:"#e4d354",reagentgray:"#818ea3",carnation:"#f45b5b",riptide:"#91e8e1",gray:"#868e96",gray100:"#f8f9fa",gray200:"#e9ecef",gray300:"#dee2e6",gray400:"#ced4da",gray500:"#adb5bd",gray600:"#868e96",gray700:"#495057",gray800:"#343a40",gray900:"#212529",graydark:"#343a40"},toRGBA=(t,e=1)=>{var a=void 0;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(t))return 3===(a=t.substring(1).split("")).length&&(a=[a[0],a[0],a[1],a[1],a[2],a[2]]),"rgba("+[(a="0x"+a.join(""))>>16&255,a>>8&255,255&a].join(",")+","+e+")"},HighchartsColors=[colors.success,colors.primary,colors.warning,colors.salmon,colors.secondary,colors.info,colors.java,colors.royalblue,colors.yellow,colors.reagentgray,colors.carnation,colors.riptide];$(()=>{Highcharts.setOptions({colors:HighchartsColors,chart:{spacingTop:15,spacingBottom:5,spacingLeft:5,height:350,zoomType:"xy",animation:!1},title:{text:""},xAxis:{labels:{style:{color:colors.gray}}},yAxis:{labels:{style:{color:colors.gray}},endOnTick:!1},credits:{enabled:!1},tooltip:{shadow:!1,animation:!1},legend:{margin:4},navigation:{buttonOptions:{y:-12}}})});const HC={bar:{plotOptions:{series:{colorByPoint:!0,groupPadding:0}},legend:{enabled:!1}},histogram:{chart:{type:"column"},tooltip:{formatter:function(){return"Frequency: "+this.y}},plotOptions:{series:{pointPadding:0,groupPadding:0}},yAxis:{allowDecimals:!1,title:{text:"Frequency"},labels:{style:{color:colors.gray500}}}},histogramStacked:{plotOptions:{column:{stacking:"normal"}},tooltip:{formatter:function(){return`<b>${this.series.name}</b><br>Frequency: ${this.y}`}}},areaSpline:{chart:{type:"areaspline"},plotOptions:{areaspline:{fillOpacity:.175,marker:{enabled:!1}}},tooltip:{formatter:function(){return`<b>${this.series.name}</b><br>Frequency: ${this.y}`}}},scatter:{chart:{type:"scatter",height:380},xAxis:{gridLineWidth:1},yAxis:{lineWidth:1}},scatterMini:{chart:{type:"scatter",height:150,width:150},title:{style:{fontSize:"11px"}},exporting:{enabled:!1},xAxis:{labels:{enabled:!1},tickLength:0,lineWidth:0},yAxis:{gridLineWidth:0,lineWidth:0,title:{text:""},labels:{enabled:!1}},legend:{enabled:!1},tooltip:{enabled:!1},plotOptions:{series:{marker:{symbol:"circle",radius:1},color:colors.secondary}}},scatter3d:{chart:{type:"scatter3d",margin:70,height:500,animation:!1,options3d:{enabled:!0,alpha:10,beta:30,depth:250,viewDistance:5,fitToPlot:!1,frame:{bottom:{size:1,color:"rgba(0,0,0,.02)"},back:{size:1,color:"rgba(0,0,0,.04)"},side:{size:1,color:"rgba(0,0,0,.06)"}}}},plotOptions:{scatter:{width:10,height:10,depth:10}},yAxis:{title:null},xAxis:{gridLineWidth:1},zAxis:{min:0,max:10,showFirstLabel:!1},legend:{enabled:!1}},qqplot:{chart:{type:"scatter",height:380},xAxis:{title:{text:"Observed Value"}},yAxis:{lineWidth:1,gridLineWidth:0},legend:{enabled:!1},tooltip:{formatter:function(){return"Expected: <b>"+this.point.y+"</b><br>Observed: <b>"+this.point.x+"</b>"}},plotOptions:{series:{marker:{symbol:"circle"}}}},boxplot:{chart:{type:"boxplot"},xAxis:{categories:[""]},yAxis:{labels:{style:{color:colors.gray500}}},legend:{enabled:!1}},pie:{chart:{type:"pie",height:400},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",center:["50%","50%"],dataLabels:{format:'<b>{point.name}</b>: <span class="fw-400">{point.percentage:.2f} %</span>',distance:15,style:{color:colors.gray700,textOutline:!1}}}},tooltip:{pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b> ({point.percentage:.2f}%)'}},pieDouble:{chart:{height:430},plotOptions:{pie:{allowPointSelect:!1,cursor:"default",dataLabels:{format:'<span class="fw-400">{point.name}</span>'}}}},packedBubble:{chart:{type:"packedbubble",height:410},plotOptions:{packedbubble:{dataLabels:{enabled:!0,format:"{point.name}",style:{color:"black",textOutline:"none",fontWeight:"normal"}},minPointSize:5}},tooltip:{pointFormat:"<b>{point.name}:</b> {point.y}"}},heatMap:{chart:{type:"heatmap",marginBottom:80,plotBorderWidth:1},colorAxis:{min:0,minColor:"#FFFFFF",maxColor:Highcharts.getOptions().colors[0]},yAxis:{title:null},legend:{align:"right",layout:"vertical",margin:0,verticalAlign:"top"}},parallelCoordinates:{chart:{parallelCoordinates:!0,parallelAxes:{lineWidth:2},height:400},xAxis:{offset:10},plotOptions:{series:{lineWidth:1,animation:!1,marker:{enabled:!1,states:{hover:{enabled:!1}}},states:{hover:{halo:{size:0}}},events:{mouseOver:function(){this.group.toFront()}}}}}},urlParams=new URLSearchParams(window.location.search),urlBase=(document.getElementsByTagName("base")[0]||{}).href,urlSegment=window.location.href.split("?")[0].split(urlBase).join("").split("/"),urlHost=window.location.host;$(()=>{$('[data-toggle="tooltip"]').tooltip(),$('[data-role="tabs"] > div').click(function(){$(this).siblings().removeClass("active"),$(this).parent().next().children().hide().eq($(this).addClass("active").index()).show()}),document.addEventListener("click",function(t){t.target.classList.contains("tab-dropdown-toggle-btn")?$(t.target.parentNode.parentNode).toggleClass("show"):$(".tab-dropdown-toggle").parent().removeClass("show")}),document.addEventListener("contextmenu",function(t){t.target.classList.contains("tab-dropdown-toggle")?$(t.target.parentNode).toggleClass("show"):t.target.classList.contains("tab-dropdown-toggle-btn")&&$(t.target.parentNode.parentNode).toggleClass("show")}),$notif.on("click",".notif",function(){$(this).addClass("d-none")})});var $notif=$("#notif-container");notif=((t,e=!1)=>{let a=$('<div class="notif">'+t+(1===e?'<i class="d-none notif-temp"></i>':"")+"</div>").delay(6e3).fadeOut();$notif.append(a),setTimeout(t=>{a.remove()},7e3),2===e&&$(".notif-temp").parent().addClass("d-none")});var $modal=$("#modal"),$modalDialog=$("#modal > .modal-dialog"),$modalTitle=$("#modal-title"),$modalBody=$("#modal-body"),$modalBtn=[$("#modal-footer > .btn-primary"),$("#modal-footer > .btn-secondary")];modal=((t,e,a={},o=["","Ok"],l=["","Cancel"],i="")=>($modalTitle.html(t),$modalBody.html(e),$modalBtn[0].html(o[1]).attr("class","btn btn-primary").addClass(o[0]).data(a),$modalBtn[1].html(l[1]).attr("class","btn btn-secondary").addClass(l[0]),$modalDialog.attr("class","modal-dialog").addClass(i),$modal.modal("show"))),$modal.length&&$modal.on("hidden.bs.modal",t=>{$modalBtn[0].removeData(),$modal.removeData()}).on("shown.bs.modal",t=>{$modal.data("shown")&&$modal.data("shown")()});