importScripts("../v3.0/utils.js"),importScripts("https://cdnjs.cloudflare.com/ajax/libs/jstat/1.7.1/jstat.min.js");export const index=(t,a,e,n,d,r)=>{const s=Date.now();let i=t["y[]"].map(t=>d[t]).join(", "),l=Ô(a[0].length,i,`by <b>${d[t.g]}</b>`),o=t["y[]"].map(t=>!a[n[t]].some(t=>null===t||isNaN(t))&&!r.find(a=>a[0]==d[t])&&ʹ(mean(a[n[t]],e))),h="";for(let a=0,e=o.length;a<e;a++)if(!1===o[a])return{error:`Invalid variable: <b class="text-warning">${d[t["y[]"][a]]}</b> contains non-numeric value`+shake("y[]")};var c=a[n[t.g]].unq();if(c.length>100)return{error:`Invalid factor: <b class="text-warning">${d[t.g]}</b> contains more than 100 unique values`+shake("g")};var m=split(a,n[t.g]);return t["y[]"].forEach((i,l)=>{if(h+=(l?"<hr>":"")+`<h6>${d[i]} <span class="fw-300">by ${d[t.g]}</span></h6>`+anovaTable(n[i],a,m,n[t.weight],o[l]),t.a){let o=a[n[i]].min(),b=a[n[i]].max(),p=histoSpline.k(a[n[i]],e),g=m.map((a,e)=>histoSpline.bin(a[n[i]],a[n[t.weight]],p,o,b).map((t,a)=>[t.mid,t.f]));h+=highcharts(s+l,["histogram","areaSpline"],"{ series: ["+c.map((a,e)=>`{ name: "${vlabel(a,r,d[t.g])}", data:${JSON.stringify(g[e])}, color:Highcharts.getOptions().colors[${e}] }`).join(",")+`], xAxis: { title: { text: '${d[i]}' } } }`)}}),t.a&&(h+=highchartsReflow(t["y[]"].map((t,a)=>s+a))),{title:"One-Way ANOVA",vars:i,body:l+h}};const anovaTable=(t,a,e,n,d)=>{let r=sst(a[t],a[n]),s=sum(e.map(a=>sst(a[t],a[n]))),i=r-s,l=e.length-1,o=len(a[t],a[n])-1,h=o-l,c=i/l,m=s/h,b=c/m,p=1-jStat.centralF.cdf(b,l,h);return`<table class="table table-sm table-bordered table-hover my-3" data-left="1" data-bold="1" style="max-width:640px">\n\t\t\t\t<thead class="text-center">\n\t\t\t\t\t<tr><th></th><th>Sum of Square</th><th class="px-3"><div title="Degree of Freedom">df</div></th><th>Mean Square</th><th>F</th><th class="px-3">Sig.</th></tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t<tr><td>Between Groups</td><td>${Ś(i,d)}</td><td>${l}</td><td>${Ś(c,d)}</td><td>${Ś(b,3)}</td><td>${Ś(p,3)}</td></tr>\n\t\t\t\t\t<tr><td>Within Groups</td><td>${Ś(s,d)}</td><td>${h}</td><td>${Ś(m,d)}</td><td></td><td></td></tr>\n\t\t\t\t\t<tr><td>Total</td><td>${Ś(r,d)}</td><td>${o}</td><td></td><td></td><td></td></tr>\n\t\t\t\t</tbody>\n\t\t\t</table>`};